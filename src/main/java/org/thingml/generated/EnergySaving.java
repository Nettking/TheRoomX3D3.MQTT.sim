/**
 * File generated by the ThingML IDE
 * /!\Do not edit this file/!\
 * In case of a bug in the generated code,
 * please submit an issue on our GitHub
 **/

package org.thingml.generated;

import no.sintef.jasm.*;
import no.sintef.jasm.ext.*;

import org.thingml.generated.api.*;
import org.thingml.generated.messages.*;

import java.util.*;

//START: @java_import annotation
import java.time.LocalTime;

//END: @java_import annotation

/**
 * Definition for type : EnergySaving
 **/
public class EnergySaving extends Component implements IEnergySaving_energy_timer, IEnergySaving_get_day_night_time, IEnergySaving_get_luminance, IEnergySaving_human_input_temp {

private boolean debug = false;
public boolean isDebug() {return debug;}
public void setDebug(boolean debug) {this.debug = debug;}
public String toString() {
String result = "instance " + getName() + "\n";
result += "\tnight_start = " + TimeStuff_night_start_var;
result += "\tnight_end = " + TimeStuff_night_end_var;
result += "\tcurrent_comfort_temp = " + EnergySaving_current_comfort_temp_var;
result += "\tcurrent_luminance = " + EnergySaving_current_luminance_var;
result += "\tlight_threshold = " + EnergySaving_light_threshold_var;
result += "\tlight_off_temp_fall = " + EnergySaving_light_off_temp_fall_var;
result += "\tnight_temp_fall = " + EnergySaving_night_temp_fall_var;
result += "";
return result;
}

public synchronized void luminance_via_get_luminance(int LuminanceMsg_luminance_id_var, double LuminanceMsg_luminance_lum_var){
final Event _msg = luminanceType.instantiate(LuminanceMsg_luminance_id_var, LuminanceMsg_luminance_lum_var);
_msg.setPort(get_luminance_port);
receive(_msg);
}

public synchronized void set_temperature_via_human_input_temp(double TemperatureMsg_set_temperature_t_var){
final Event _msg = set_temperatureType.instantiate(TemperatureMsg_set_temperature_t_var);
_msg.setPort(human_input_temp_port);
receive(_msg);
}

public synchronized void set_day_start_via_get_day_night_time(int LuminanceMsg_set_day_start_time_var){
final Event _msg = set_day_startType.instantiate(LuminanceMsg_set_day_start_time_var);
_msg.setPort(get_day_night_time_port);
receive(_msg);
}

public synchronized void set_night_start_via_get_day_night_time(int LuminanceMsg_set_night_start_time_var){
final Event _msg = set_night_startType.instantiate(LuminanceMsg_set_night_start_time_var);
_msg.setPort(get_day_night_time_port);
receive(_msg);
}

public synchronized void timer_timeout_via_energy_timer(){
final Event _msg = timer_timeoutType.instantiate();
_msg.setPort(energy_timer_port);
receive(_msg);
}

private void sendSet_temperature_via_send_comfort_temp(double TemperatureMsg_set_temperature_t_var){
send_comfort_temp_port.send(set_temperatureType.instantiate(TemperatureMsg_set_temperature_t_var));
}

private void sendTimer_start_via_energy_timer(int TimerMsgs_timer_start_delay_var){
energy_timer_port.send(timer_startType.instantiate(TimerMsgs_timer_start_delay_var));
}

private void sendTimer_cancel_via_energy_timer(){
energy_timer_port.send(timer_cancelType.instantiate());
}

private void sendAdd_lightsensor_via_request_luminance_sensor(int LuminanceMsg_add_lightsensor_id_var){
request_luminance_sensor_port.send(add_lightsensorType.instantiate(LuminanceMsg_add_lightsensor_id_var));
}

//Attributes
private double EnergySaving_night_temp_fall_var;
private long TimeStuff_night_end_var;
private double EnergySaving_current_luminance_var;
private double EnergySaving_light_threshold_var;
private double EnergySaving_current_comfort_temp_var;
private long TimeStuff_night_start_var;
private double EnergySaving_light_off_temp_fall_var;
//Ports
private Port get_luminance_port;
private Port human_input_temp_port;
private Port get_day_night_time_port;
private Port send_comfort_temp_port;
private Port energy_timer_port;
private Port request_luminance_sensor_port;
//Message types
protected final LuminanceMessageType luminanceType = new LuminanceMessageType();
protected final Add_lightsensorMessageType add_lightsensorType = new Add_lightsensorMessageType();
protected final Set_luminanceMessageType set_luminanceType = new Set_luminanceMessageType();
protected final Set_day_startMessageType set_day_startType = new Set_day_startMessageType();
protected final Set_night_startMessageType set_night_startType = new Set_night_startMessageType();
protected final TemperatureMessageType temperatureType = new TemperatureMessageType();
protected final Add_thermometerMessageType add_thermometerType = new Add_thermometerMessageType();
protected final Set_temperatureMessageType set_temperatureType = new Set_temperatureMessageType();
protected final Set_deltaMessageType set_deltaType = new Set_deltaMessageType();
protected final Fetch_tempMessageType fetch_tempType = new Fetch_tempMessageType();
protected final Timer_startMessageType timer_startType = new Timer_startMessageType();
protected final Timer_cancelMessageType timer_cancelType = new Timer_cancelMessageType();
protected final Timer_timeoutMessageType timer_timeoutType = new Timer_timeoutMessageType();
//Empty Constructor
public EnergySaving() {
super();
}

//Getters and Setters for non readonly/final attributes
public double getEnergySaving_night_temp_fall_var() {
return EnergySaving_night_temp_fall_var;
}

public void setEnergySaving_night_temp_fall_var(double EnergySaving_night_temp_fall_var) {
this.EnergySaving_night_temp_fall_var = EnergySaving_night_temp_fall_var;
}

public EnergySaving initEnergySaving_night_temp_fall_var(double EnergySaving_night_temp_fall_var) {
this.EnergySaving_night_temp_fall_var = EnergySaving_night_temp_fall_var;
return this;
}

public long getTimeStuff_night_end_var() {
return TimeStuff_night_end_var;
}

public void setTimeStuff_night_end_var(long TimeStuff_night_end_var) {
this.TimeStuff_night_end_var = TimeStuff_night_end_var;
}

public EnergySaving initTimeStuff_night_end_var(long TimeStuff_night_end_var) {
this.TimeStuff_night_end_var = TimeStuff_night_end_var;
return this;
}

public double getEnergySaving_current_luminance_var() {
return EnergySaving_current_luminance_var;
}

public void setEnergySaving_current_luminance_var(double EnergySaving_current_luminance_var) {
this.EnergySaving_current_luminance_var = EnergySaving_current_luminance_var;
}

public EnergySaving initEnergySaving_current_luminance_var(double EnergySaving_current_luminance_var) {
this.EnergySaving_current_luminance_var = EnergySaving_current_luminance_var;
return this;
}

public double getEnergySaving_light_threshold_var() {
return EnergySaving_light_threshold_var;
}

public void setEnergySaving_light_threshold_var(double EnergySaving_light_threshold_var) {
this.EnergySaving_light_threshold_var = EnergySaving_light_threshold_var;
}

public EnergySaving initEnergySaving_light_threshold_var(double EnergySaving_light_threshold_var) {
this.EnergySaving_light_threshold_var = EnergySaving_light_threshold_var;
return this;
}

public double getEnergySaving_current_comfort_temp_var() {
return EnergySaving_current_comfort_temp_var;
}

public void setEnergySaving_current_comfort_temp_var(double EnergySaving_current_comfort_temp_var) {
this.EnergySaving_current_comfort_temp_var = EnergySaving_current_comfort_temp_var;
}

public EnergySaving initEnergySaving_current_comfort_temp_var(double EnergySaving_current_comfort_temp_var) {
this.EnergySaving_current_comfort_temp_var = EnergySaving_current_comfort_temp_var;
return this;
}

public long getTimeStuff_night_start_var() {
return TimeStuff_night_start_var;
}

public void setTimeStuff_night_start_var(long TimeStuff_night_start_var) {
this.TimeStuff_night_start_var = TimeStuff_night_start_var;
}

public EnergySaving initTimeStuff_night_start_var(long TimeStuff_night_start_var) {
this.TimeStuff_night_start_var = TimeStuff_night_start_var;
return this;
}

public double getEnergySaving_light_off_temp_fall_var() {
return EnergySaving_light_off_temp_fall_var;
}

public void setEnergySaving_light_off_temp_fall_var(double EnergySaving_light_off_temp_fall_var) {
this.EnergySaving_light_off_temp_fall_var = EnergySaving_light_off_temp_fall_var;
}

public EnergySaving initEnergySaving_light_off_temp_fall_var(double EnergySaving_light_off_temp_fall_var) {
this.EnergySaving_light_off_temp_fall_var = EnergySaving_light_off_temp_fall_var;
return this;
}

//Getters for Ports
public Port getGet_luminance_port() {
return get_luminance_port;
}
public Port getHuman_input_temp_port() {
return human_input_temp_port;
}
public Port getGet_day_night_time_port() {
return get_day_night_time_port;
}
public Port getSend_comfort_temp_port() {
return send_comfort_temp_port;
}
public Port getEnergy_timer_port() {
return energy_timer_port;
}
public Port getRequest_luminance_sensor_port() {
return request_luminance_sensor_port;
}
private CompositeState buildEnergySaving_EnergySaving(){
final AtomicState state_EnergySaving_EnergySaving_Normal = new AtomicState("Normal");
state_EnergySaving_EnergySaving_Normal.onEntry(()->{
System.out.println(""+((" I am in normal state ")));
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var()));
});
final AtomicState state_EnergySaving_EnergySaving_LightOff = new AtomicState("LightOff");
state_EnergySaving_EnergySaving_LightOff.onEntry(()->{
System.out.println(""+((" I am in LightOff state ")));
sendTimer_start_via_energy_timer((int) (LeftOfDay()));
});
state_EnergySaving_EnergySaving_LightOff.onExit(()->{
sendTimer_cancel_via_energy_timer();
});

final AtomicState state_EnergySaving_EnergySaving_Night = new AtomicState("Night");
state_EnergySaving_EnergySaving_Night.onEntry(()->{
System.out.println(""+((" I am in night state ")));
sendTimer_start_via_energy_timer((int) (LeftOfNight()));
});
state_EnergySaving_EnergySaving_Night.onExit(()->{
sendTimer_cancel_via_energy_timer();
});

Transition h2056499811 = new Transition();
h2056499811.from(state_EnergySaving_EnergySaving_Normal).to(state_EnergySaving_EnergySaving_Normal);
h2056499811.event(set_temperatureType);
h2056499811.port(human_input_temp_port);
h2056499811.action((Event e)->{
final Set_temperatureMessageType.Set_temperatureMessage set_temperature = (Set_temperatureMessageType.Set_temperatureMessage) e;
EnergySaving_current_comfort_temp_var = (double) (set_temperature.t);
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var()));
});

Transition h952288009 = new Transition();
h952288009.from(state_EnergySaving_EnergySaving_Normal).to(state_EnergySaving_EnergySaving_LightOff);
h952288009.event(luminanceType);
h952288009.guard((Event e)->{
final LuminanceMessageType.LuminanceMessage luminance = (LuminanceMessageType.LuminanceMessage) e;
return luminance.lum < getEnergySaving_light_threshold_var() && (Night((long) (Now())) == false);
});

h952288009.port(get_luminance_port);
h952288009.action((Event e)->{
final LuminanceMessageType.LuminanceMessage luminance = (LuminanceMessageType.LuminanceMessage) e;
EnergySaving_current_luminance_var = (double) (luminance.lum);
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var() - getEnergySaving_light_off_temp_fall_var()));
});

Transition h323761934 = new Transition();
h323761934.from(state_EnergySaving_EnergySaving_Normal).to(state_EnergySaving_EnergySaving_Night);
h323761934.event(luminanceType);
h323761934.guard((Event e)->{
final LuminanceMessageType.LuminanceMessage luminance = (LuminanceMessageType.LuminanceMessage) e;
return luminance.lum < getEnergySaving_light_threshold_var() && (Night((long) (Now())) == true);
});

h323761934.port(get_luminance_port);
h323761934.action((Event e)->{
final LuminanceMessageType.LuminanceMessage luminance = (LuminanceMessageType.LuminanceMessage) e;
EnergySaving_current_luminance_var = (double) (luminance.lum);
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var() - getEnergySaving_night_temp_fall_var()));
});

Transition h1410008136 = new Transition();
h1410008136.from(state_EnergySaving_EnergySaving_Normal).to(state_EnergySaving_EnergySaving_LightOff);
h1410008136.event(set_night_startType);
h1410008136.guard((Event e)->{
final Set_night_startMessageType.Set_night_startMessage set_night_start = (Set_night_startMessageType.Set_night_startMessage) e;
return getEnergySaving_current_luminance_var() < getEnergySaving_light_threshold_var() && (UpdateNightStart((long) (Now()), (long) (set_night_start.time)) == false);
});

h1410008136.port(get_day_night_time_port);
h1410008136.action((Event e)->{
final Set_night_startMessageType.Set_night_startMessage set_night_start = (Set_night_startMessageType.Set_night_startMessage) e;
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var() - getEnergySaving_light_off_temp_fall_var()));
});

Transition h598977164 = new Transition();
h598977164.from(state_EnergySaving_EnergySaving_Normal).to(state_EnergySaving_EnergySaving_Night);
h598977164.event(set_night_startType);
h598977164.guard((Event e)->{
final Set_night_startMessageType.Set_night_startMessage set_night_start = (Set_night_startMessageType.Set_night_startMessage) e;
return getEnergySaving_current_luminance_var() < getEnergySaving_light_threshold_var() && (UpdateNightStart((long) (Now()), (long) (set_night_start.time)) == true);
});

h598977164.port(get_day_night_time_port);
h598977164.action((Event e)->{
final Set_night_startMessageType.Set_night_startMessage set_night_start = (Set_night_startMessageType.Set_night_startMessage) e;
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var() - getEnergySaving_night_temp_fall_var()));
});

Transition h812031404 = new Transition();
h812031404.from(state_EnergySaving_EnergySaving_Normal).to(state_EnergySaving_EnergySaving_Normal);
h812031404.event(set_day_startType);
h812031404.guard((Event e)->{
final Set_day_startMessageType.Set_day_startMessage set_day_start = (Set_day_startMessageType.Set_day_startMessage) e;
return getEnergySaving_current_luminance_var() >= getEnergySaving_light_threshold_var();
});

h812031404.port(get_day_night_time_port);
h812031404.action((Event e)->{
final Set_day_startMessageType.Set_day_startMessage set_day_start = (Set_day_startMessageType.Set_day_startMessage) e;
TimeStuff_night_end_var = (long) (set_day_start.time);
});

Transition h1878267309 = new Transition();
h1878267309.from(state_EnergySaving_EnergySaving_Normal).to(state_EnergySaving_EnergySaving_Normal);
h1878267309.event(set_night_startType);
h1878267309.guard((Event e)->{
final Set_night_startMessageType.Set_night_startMessage set_night_start = (Set_night_startMessageType.Set_night_startMessage) e;
return getEnergySaving_current_luminance_var() >= getEnergySaving_light_threshold_var();
});

h1878267309.port(get_day_night_time_port);
h1878267309.action((Event e)->{
final Set_night_startMessageType.Set_night_startMessage set_night_start = (Set_night_startMessageType.Set_night_startMessage) e;
TimeStuff_night_start_var = (long) (set_night_start.time);
});

Transition h515036017 = new Transition();
h515036017.from(state_EnergySaving_EnergySaving_LightOff).to(state_EnergySaving_EnergySaving_Night);
h515036017.event(timer_timeoutType);
h515036017.port(energy_timer_port);
h515036017.action((Event e)->{
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var() - getEnergySaving_night_temp_fall_var()));
});

Transition h1885562991 = new Transition();
h1885562991.from(state_EnergySaving_EnergySaving_LightOff).to(state_EnergySaving_EnergySaving_Normal);
h1885562991.event(luminanceType);
h1885562991.guard((Event e)->{
final LuminanceMessageType.LuminanceMessage luminance = (LuminanceMessageType.LuminanceMessage) e;
return luminance.lum >= getEnergySaving_light_threshold_var();
});

h1885562991.port(get_luminance_port);
h1885562991.action((Event e)->{
final LuminanceMessageType.LuminanceMessage luminance = (LuminanceMessageType.LuminanceMessage) e;
EnergySaving_current_luminance_var = (double) (luminance.lum);
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var()));
});

Transition h430983166 = new Transition();
h430983166.from(state_EnergySaving_EnergySaving_LightOff).to(state_EnergySaving_EnergySaving_LightOff);
h430983166.event(set_temperatureType);
h430983166.port(human_input_temp_port);
h430983166.action((Event e)->{
final Set_temperatureMessageType.Set_temperatureMessage set_temperature = (Set_temperatureMessageType.Set_temperatureMessage) e;
sendSet_temperature_via_send_comfort_temp((double) (set_temperature.t - getEnergySaving_light_off_temp_fall_var()));
});

Transition h293667566 = new Transition();
h293667566.from(state_EnergySaving_EnergySaving_LightOff).to(state_EnergySaving_EnergySaving_Night);
h293667566.event(set_night_startType);
h293667566.guard((Event e)->{
final Set_night_startMessageType.Set_night_startMessage set_night_start = (Set_night_startMessageType.Set_night_startMessage) e;
return (UpdateNightStart((long) (Now()), (long) (set_night_start.time)) == true) && getEnergySaving_current_luminance_var() < getEnergySaving_light_threshold_var();
});

h293667566.port(get_day_night_time_port);
h293667566.action((Event e)->{
final Set_night_startMessageType.Set_night_startMessage set_night_start = (Set_night_startMessageType.Set_night_startMessage) e;
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var() - getEnergySaving_night_temp_fall_var()));
});

Transition h146346292 = new Transition();
h146346292.from(state_EnergySaving_EnergySaving_LightOff).to(state_EnergySaving_EnergySaving_Night);
h146346292.event(set_day_startType);
h146346292.guard((Event e)->{
final Set_day_startMessageType.Set_day_startMessage set_day_start = (Set_day_startMessageType.Set_day_startMessage) e;
return getEnergySaving_current_luminance_var() < getEnergySaving_light_threshold_var() && (UpdateNightEnd((long) (Now()), (long) (set_day_start.time)) == true);
});

h146346292.port(get_day_night_time_port);
h146346292.action((Event e)->{
final Set_day_startMessageType.Set_day_startMessage set_day_start = (Set_day_startMessageType.Set_day_startMessage) e;
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var() - getEnergySaving_light_off_temp_fall_var()));
});

Transition h390034407 = new Transition();
h390034407.from(state_EnergySaving_EnergySaving_LightOff).to(state_EnergySaving_EnergySaving_LightOff);
h390034407.event(set_night_startType);
h390034407.guard((Event e)->{
final Set_night_startMessageType.Set_night_startMessage set_night_start = (Set_night_startMessageType.Set_night_startMessage) e;
return getEnergySaving_current_luminance_var() < getEnergySaving_light_threshold_var() && (UpdateNightStart((long) (Now()), (long) (set_night_start.time)) == false);
});

h390034407.port(get_day_night_time_port);
Transition h1103067610 = new Transition();
h1103067610.from(state_EnergySaving_EnergySaving_LightOff).to(state_EnergySaving_EnergySaving_LightOff);
h1103067610.event(set_day_startType);
h1103067610.guard((Event e)->{
final Set_day_startMessageType.Set_day_startMessage set_day_start = (Set_day_startMessageType.Set_day_startMessage) e;
return getEnergySaving_current_luminance_var() < getEnergySaving_light_threshold_var() && (UpdateNightEnd((long) (Now()), (long) (set_day_start.time)) == false);
});

h1103067610.port(get_day_night_time_port);
Transition h1126112943 = new Transition();
h1126112943.from(state_EnergySaving_EnergySaving_Night).to(state_EnergySaving_EnergySaving_LightOff);
h1126112943.event(timer_timeoutType);
h1126112943.port(energy_timer_port);
h1126112943.action((Event e)->{
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var() - getEnergySaving_light_off_temp_fall_var()));
});

Transition h922547904 = new Transition();
h922547904.from(state_EnergySaving_EnergySaving_Night).to(state_EnergySaving_EnergySaving_Normal);
h922547904.event(luminanceType);
h922547904.guard((Event e)->{
final LuminanceMessageType.LuminanceMessage luminance = (LuminanceMessageType.LuminanceMessage) e;
return luminance.lum >= getEnergySaving_light_threshold_var();
});

h922547904.port(get_luminance_port);
h922547904.action((Event e)->{
final LuminanceMessageType.LuminanceMessage luminance = (LuminanceMessageType.LuminanceMessage) e;
EnergySaving_current_luminance_var = (double) (luminance.lum);
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var()));
});

Transition h1046302571 = new Transition();
h1046302571.from(state_EnergySaving_EnergySaving_Night).to(state_EnergySaving_EnergySaving_Night);
h1046302571.event(set_temperatureType);
h1046302571.port(human_input_temp_port);
h1046302571.action((Event e)->{
final Set_temperatureMessageType.Set_temperatureMessage set_temperature = (Set_temperatureMessageType.Set_temperatureMessage) e;
EnergySaving_current_comfort_temp_var = (double) (set_temperature.t - getEnergySaving_night_temp_fall_var());
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var()));
});

Transition h1932303196 = new Transition();
h1932303196.from(state_EnergySaving_EnergySaving_Night).to(state_EnergySaving_EnergySaving_LightOff);
h1932303196.event(set_night_startType);
h1932303196.guard((Event e)->{
final Set_night_startMessageType.Set_night_startMessage set_night_start = (Set_night_startMessageType.Set_night_startMessage) e;
return getEnergySaving_current_luminance_var() < getEnergySaving_light_threshold_var() && (UpdateNightStart((long) (Now()), (long) (set_night_start.time)) == false);
});

h1932303196.port(get_day_night_time_port);
h1932303196.action((Event e)->{
final Set_night_startMessageType.Set_night_startMessage set_night_start = (Set_night_startMessageType.Set_night_startMessage) e;
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var() - getEnergySaving_light_off_temp_fall_var()));
});

Transition h956856274 = new Transition();
h956856274.from(state_EnergySaving_EnergySaving_Night).to(state_EnergySaving_EnergySaving_LightOff);
h956856274.event(set_day_startType);
h956856274.guard((Event e)->{
final Set_day_startMessageType.Set_day_startMessage set_day_start = (Set_day_startMessageType.Set_day_startMessage) e;
return getEnergySaving_current_luminance_var() < getEnergySaving_light_threshold_var() && (UpdateNightEnd((long) (Now()), (long) (set_day_start.time)) == false);
});

h956856274.port(get_day_night_time_port);
h956856274.action((Event e)->{
final Set_day_startMessageType.Set_day_startMessage set_day_start = (Set_day_startMessageType.Set_day_startMessage) e;
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var() - getEnergySaving_light_off_temp_fall_var()));
});

Transition h1998371610 = new Transition();
h1998371610.from(state_EnergySaving_EnergySaving_Night).to(state_EnergySaving_EnergySaving_Night);
h1998371610.event(set_night_startType);
h1998371610.guard((Event e)->{
final Set_night_startMessageType.Set_night_startMessage set_night_start = (Set_night_startMessageType.Set_night_startMessage) e;
return getEnergySaving_current_luminance_var() < getEnergySaving_light_threshold_var() && (UpdateNightStart((long) (Now()), (long) (set_night_start.time)) == true);
});

h1998371610.port(get_day_night_time_port);
Transition h567391009 = new Transition();
h567391009.from(state_EnergySaving_EnergySaving_Night).to(state_EnergySaving_EnergySaving_Night);
h567391009.event(set_day_startType);
h567391009.guard((Event e)->{
final Set_day_startMessageType.Set_day_startMessage set_day_start = (Set_day_startMessageType.Set_day_startMessage) e;
return getEnergySaving_current_luminance_var() < getEnergySaving_light_threshold_var() && (UpdateNightEnd((long) (Now()), (long) (set_day_start.time)) == true);
});

h567391009.port(get_day_night_time_port);
final CompositeState state_EnergySaving_EnergySaving = new CompositeState("EnergySaving");
state_EnergySaving_EnergySaving.onEntry(()->{
sendAdd_lightsensor_via_request_luminance_sensor((int) (1));
});
state_EnergySaving_EnergySaving.add(state_EnergySaving_EnergySaving_Normal);
state_EnergySaving_EnergySaving.add(state_EnergySaving_EnergySaving_LightOff);
state_EnergySaving_EnergySaving.add(state_EnergySaving_EnergySaving_Night);
state_EnergySaving_EnergySaving.initial(state_EnergySaving_EnergySaving_Normal);
return state_EnergySaving_EnergySaving;
}

public Component buildBehavior(String session, Component root) {
if (root == null) {
//Init ports
get_luminance_port = new Port("get_luminance", this);
human_input_temp_port = new Port("human_input_temp", this);
get_day_night_time_port = new Port("get_day_night_time", this);
send_comfort_temp_port = new Port("send_comfort_temp", this);
energy_timer_port = new Port("energy_timer", this);
request_luminance_sensor_port = new Port("request_luminance_sensor", this);
} else {
get_luminance_port = ((EnergySaving)root).get_luminance_port;
human_input_temp_port = ((EnergySaving)root).human_input_temp_port;
get_day_night_time_port = ((EnergySaving)root).get_day_night_time_port;
send_comfort_temp_port = ((EnergySaving)root).send_comfort_temp_port;
energy_timer_port = ((EnergySaving)root).energy_timer_port;
request_luminance_sensor_port = ((EnergySaving)root).request_luminance_sensor_port;
}
if (session == null){
//Init state machine
behavior = buildEnergySaving_EnergySaving();
}
return this;
}

 long Now() {
long timeval_var = 0;
timeval_var = (long) (LocalTime.now().toNanoOfDay()/1000000);
return (long) (timeval_var);
}
 long Timestamp(final int TimeStuff_Timestamp_h_var, final int TimeStuff_Timestamp_m_var, final int TimeStuff_Timestamp_s_var) {
return (long) ((TimeStuff_Timestamp_s_var + TimeStuff_Timestamp_m_var * 60 + TimeStuff_Timestamp_h_var * 60 * 60) * 1000);
}
 long LeftOfDay() {
long n_var = (long) (Now());

long left_var = (long) (getTimeStuff_night_start_var() - n_var);

if(left_var < 0) {
left_var = (long) (left_var + 24 * 60 * 60 * 1000);

}
if( !(Night((long) (n_var)))) {
return (long) (left_var);

} else {
return (long) (0);

}
}
 long LeftOfNight() {
long n_var = (long) (Now());

long left_var = (long) (getTimeStuff_night_end_var() - n_var);

if(left_var < 0) {
left_var = (long) (left_var + 24 * 60 * 60 * 1000);

}
if(Night((long) (n_var))) {
return (long) (left_var);

} else {
return (long) (0);

}
}
 boolean Night(final long TimeStuff_Night_x_var) {
if(getTimeStuff_night_end_var() < getTimeStuff_night_start_var()) {
if(getTimeStuff_night_start_var() <= TimeStuff_Night_x_var || TimeStuff_Night_x_var < getTimeStuff_night_end_var()) {
return (boolean) (true);

} else {
return (boolean) (false);

}

} else {
if(getTimeStuff_night_start_var() <= TimeStuff_Night_x_var && TimeStuff_Night_x_var < getTimeStuff_night_end_var()) {
return (boolean) (true);

} else {
return (boolean) (false);

}

}
}
 boolean UpdateNightStart(final long TimeStuff_UpdateNightStart_x_var, final long TimeStuff_UpdateNightStart_new_night_start_var) {
System.out.println(""+((" Old night start: ")));
System.out.println(""+((getTimeStuff_night_start_var())));
TimeStuff_night_start_var = (long) (TimeStuff_UpdateNightStart_new_night_start_var);
System.out.println(""+((" New night start: ")));
System.out.println(""+((getTimeStuff_night_start_var())));
boolean isNight_var = (boolean) (Night((long) (TimeStuff_UpdateNightStart_x_var)));

System.out.println(""+((isNight_var)));
return (boolean) (isNight_var);
}
 boolean UpdateNightEnd(final long TimeStuff_UpdateNightEnd_x_var, final long TimeStuff_UpdateNightEnd_new_night_end_var) {
System.out.println(""+((" Old night_end: ")));
System.out.println(""+((getTimeStuff_night_start_var())));
TimeStuff_night_end_var = (long) (TimeStuff_UpdateNightEnd_new_night_end_var);
System.out.println(""+((" New night_end: ")));
System.out.println(""+((getTimeStuff_night_start_var())));
boolean isNight_var = (boolean) (Night((long) (TimeStuff_UpdateNightEnd_x_var)));

System.out.println(""+((isNight_var)));
return (boolean) (isNight_var);
}
}
