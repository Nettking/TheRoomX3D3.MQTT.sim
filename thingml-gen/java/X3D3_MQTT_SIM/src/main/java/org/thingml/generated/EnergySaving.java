/**
 * File generated by the ThingML IDE
 * /!\Do not edit this file/!\
 * In case of a bug in the generated code,
 * please submit an issue on our GitHub
 **/

package org.thingml.generated;

import no.sintef.jasm.*;
import no.sintef.jasm.ext.*;

import org.thingml.generated.api.*;
import org.thingml.generated.messages.*;

import java.util.*;

//START: @java_import annotation
import java.time.LocalTime;

//END: @java_import annotation

/**
 * Definition for type : EnergySaving
 **/
public class EnergySaving extends Component implements IEnergySaving_energy_timer, IEnergySaving_get_day_night_time, IEnergySaving_get_luminance, IEnergySaving_human_input_temp {

private boolean debug = false;
public boolean isDebug() {return debug;}
public void setDebug(boolean debug) {this.debug = debug;}
public String toString() {
String result = "instance " + getName() + "\n";
result += "\tnight_start = " + TimeStuff_night_start_var;
result += "\tnight_end = " + TimeStuff_night_end_var;
result += "\tcurrent_comfort_temp = " + EnergySaving_current_comfort_temp_var;
result += "\tcurrent_luminance = " + EnergySaving_current_luminance_var;
result += "\tlight_threshold = " + EnergySaving_light_threshold_var;
result += "\tlight_off_temp_fall = " + EnergySaving_light_off_temp_fall_var;
result += "\tnight_temp_fall = " + EnergySaving_night_temp_fall_var;
result += "";
return result;
}

public synchronized void luminance_via_get_luminance(int LuminanceMsg_luminance_id_var, double LuminanceMsg_luminance_lum_var){
final Event _msg = luminanceType.instantiate(LuminanceMsg_luminance_id_var, LuminanceMsg_luminance_lum_var);
_msg.setPort(get_luminance_port);
receive(_msg);
}

public synchronized void set_temperature_via_human_input_temp(double TemperatureMsg_set_temperature_t_var){
final Event _msg = set_temperatureType.instantiate(TemperatureMsg_set_temperature_t_var);
_msg.setPort(human_input_temp_port);
receive(_msg);
}

public synchronized void set_day_start_via_get_day_night_time(int LuminanceMsg_set_day_start_time_var){
final Event _msg = set_day_startType.instantiate(LuminanceMsg_set_day_start_time_var);
_msg.setPort(get_day_night_time_port);
receive(_msg);
}

public synchronized void set_night_start_via_get_day_night_time(int LuminanceMsg_set_night_start_time_var){
final Event _msg = set_night_startType.instantiate(LuminanceMsg_set_night_start_time_var);
_msg.setPort(get_day_night_time_port);
receive(_msg);
}

public synchronized void timer_timeout_via_energy_timer(){
final Event _msg = timer_timeoutType.instantiate();
_msg.setPort(energy_timer_port);
receive(_msg);
}

private void sendSet_temperature_via_send_comfort_temp(double TemperatureMsg_set_temperature_t_var){
send_comfort_temp_port.send(set_temperatureType.instantiate(TemperatureMsg_set_temperature_t_var));
}

private void sendTimer_start_via_energy_timer(int TimerMsgs_timer_start_delay_var){
energy_timer_port.send(timer_startType.instantiate(TimerMsgs_timer_start_delay_var));
}

private void sendTimer_cancel_via_energy_timer(){
energy_timer_port.send(timer_cancelType.instantiate());
}

private void sendAdd_lightsensor_via_request_luminance_sensor(int LuminanceMsg_add_lightsensor_id_var){
request_luminance_sensor_port.send(add_lightsensorType.instantiate(LuminanceMsg_add_lightsensor_id_var));
}

//Attributes
private long TimeStuff_night_start_var;
private double EnergySaving_light_threshold_var;
private double EnergySaving_current_comfort_temp_var;
private double EnergySaving_current_luminance_var;
private long TimeStuff_night_end_var;
private double EnergySaving_light_off_temp_fall_var;
private double EnergySaving_night_temp_fall_var;
//Ports
private Port get_luminance_port;
private Port human_input_temp_port;
private Port get_day_night_time_port;
private Port send_comfort_temp_port;
private Port energy_timer_port;
private Port request_luminance_sensor_port;
//Message types
protected final LuminanceMessageType luminanceType = new LuminanceMessageType();
protected final Add_lightsensorMessageType add_lightsensorType = new Add_lightsensorMessageType();
protected final Set_luminanceMessageType set_luminanceType = new Set_luminanceMessageType();
protected final Set_day_startMessageType set_day_startType = new Set_day_startMessageType();
protected final Set_night_startMessageType set_night_startType = new Set_night_startMessageType();
protected final TemperatureMessageType temperatureType = new TemperatureMessageType();
protected final Add_thermometerMessageType add_thermometerType = new Add_thermometerMessageType();
protected final Set_temperatureMessageType set_temperatureType = new Set_temperatureMessageType();
protected final Set_deltaMessageType set_deltaType = new Set_deltaMessageType();
protected final Fetch_tempMessageType fetch_tempType = new Fetch_tempMessageType();
protected final Timer_startMessageType timer_startType = new Timer_startMessageType();
protected final Timer_cancelMessageType timer_cancelType = new Timer_cancelMessageType();
protected final Timer_timeoutMessageType timer_timeoutType = new Timer_timeoutMessageType();
//Empty Constructor
public EnergySaving() {
super();
}

//Getters and Setters for non readonly/final attributes
public long getTimeStuff_night_start_var() {
return TimeStuff_night_start_var;
}

public void setTimeStuff_night_start_var(long TimeStuff_night_start_var) {
this.TimeStuff_night_start_var = TimeStuff_night_start_var;
}

public EnergySaving initTimeStuff_night_start_var(long TimeStuff_night_start_var) {
this.TimeStuff_night_start_var = TimeStuff_night_start_var;
return this;
}

public double getEnergySaving_light_threshold_var() {
return EnergySaving_light_threshold_var;
}

public void setEnergySaving_light_threshold_var(double EnergySaving_light_threshold_var) {
this.EnergySaving_light_threshold_var = EnergySaving_light_threshold_var;
}

public EnergySaving initEnergySaving_light_threshold_var(double EnergySaving_light_threshold_var) {
this.EnergySaving_light_threshold_var = EnergySaving_light_threshold_var;
return this;
}

public double getEnergySaving_current_comfort_temp_var() {
return EnergySaving_current_comfort_temp_var;
}

public void setEnergySaving_current_comfort_temp_var(double EnergySaving_current_comfort_temp_var) {
this.EnergySaving_current_comfort_temp_var = EnergySaving_current_comfort_temp_var;
}

public EnergySaving initEnergySaving_current_comfort_temp_var(double EnergySaving_current_comfort_temp_var) {
this.EnergySaving_current_comfort_temp_var = EnergySaving_current_comfort_temp_var;
return this;
}

public double getEnergySaving_current_luminance_var() {
return EnergySaving_current_luminance_var;
}

public void setEnergySaving_current_luminance_var(double EnergySaving_current_luminance_var) {
this.EnergySaving_current_luminance_var = EnergySaving_current_luminance_var;
}

public EnergySaving initEnergySaving_current_luminance_var(double EnergySaving_current_luminance_var) {
this.EnergySaving_current_luminance_var = EnergySaving_current_luminance_var;
return this;
}

public long getTimeStuff_night_end_var() {
return TimeStuff_night_end_var;
}

public void setTimeStuff_night_end_var(long TimeStuff_night_end_var) {
this.TimeStuff_night_end_var = TimeStuff_night_end_var;
}

public EnergySaving initTimeStuff_night_end_var(long TimeStuff_night_end_var) {
this.TimeStuff_night_end_var = TimeStuff_night_end_var;
return this;
}

public double getEnergySaving_light_off_temp_fall_var() {
return EnergySaving_light_off_temp_fall_var;
}

public void setEnergySaving_light_off_temp_fall_var(double EnergySaving_light_off_temp_fall_var) {
this.EnergySaving_light_off_temp_fall_var = EnergySaving_light_off_temp_fall_var;
}

public EnergySaving initEnergySaving_light_off_temp_fall_var(double EnergySaving_light_off_temp_fall_var) {
this.EnergySaving_light_off_temp_fall_var = EnergySaving_light_off_temp_fall_var;
return this;
}

public double getEnergySaving_night_temp_fall_var() {
return EnergySaving_night_temp_fall_var;
}

public void setEnergySaving_night_temp_fall_var(double EnergySaving_night_temp_fall_var) {
this.EnergySaving_night_temp_fall_var = EnergySaving_night_temp_fall_var;
}

public EnergySaving initEnergySaving_night_temp_fall_var(double EnergySaving_night_temp_fall_var) {
this.EnergySaving_night_temp_fall_var = EnergySaving_night_temp_fall_var;
return this;
}

//Getters for Ports
public Port getGet_luminance_port() {
return get_luminance_port;
}
public Port getHuman_input_temp_port() {
return human_input_temp_port;
}
public Port getGet_day_night_time_port() {
return get_day_night_time_port;
}
public Port getSend_comfort_temp_port() {
return send_comfort_temp_port;
}
public Port getEnergy_timer_port() {
return energy_timer_port;
}
public Port getRequest_luminance_sensor_port() {
return request_luminance_sensor_port;
}
private CompositeState buildEnergySaving_EnergySaving(){
final AtomicState state_EnergySaving_EnergySaving_Normal = new AtomicState("Normal");
state_EnergySaving_EnergySaving_Normal.onEntry(()->{
System.out.println(""+((" I am in normal state ")));
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var()));
});
final AtomicState state_EnergySaving_EnergySaving_LightOff = new AtomicState("LightOff");
state_EnergySaving_EnergySaving_LightOff.onEntry(()->{
System.out.println(""+((" I am in LightOff state ")));
sendTimer_start_via_energy_timer((int) (LeftOfDay()));
});
state_EnergySaving_EnergySaving_LightOff.onExit(()->{
sendTimer_cancel_via_energy_timer();
});

final AtomicState state_EnergySaving_EnergySaving_Night = new AtomicState("Night");
state_EnergySaving_EnergySaving_Night.onEntry(()->{
System.out.println(""+((" I am in night state ")));
sendTimer_start_via_energy_timer((int) (LeftOfNight()));
});
state_EnergySaving_EnergySaving_Night.onExit(()->{
sendTimer_cancel_via_energy_timer();
});

Transition h1381906569 = new Transition();
h1381906569.from(state_EnergySaving_EnergySaving_Normal).to(state_EnergySaving_EnergySaving_Normal);
h1381906569.event(set_temperatureType);
h1381906569.port(human_input_temp_port);
h1381906569.action((Event e)->{
final Set_temperatureMessageType.Set_temperatureMessage set_temperature = (Set_temperatureMessageType.Set_temperatureMessage) e;
EnergySaving_current_comfort_temp_var = (double) (set_temperature.t);
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var()));
});

Transition h1156521327 = new Transition();
h1156521327.from(state_EnergySaving_EnergySaving_Normal).to(state_EnergySaving_EnergySaving_LightOff);
h1156521327.event(luminanceType);
h1156521327.guard((Event e)->{
final LuminanceMessageType.LuminanceMessage luminance = (LuminanceMessageType.LuminanceMessage) e;
return luminance.lum < getEnergySaving_light_threshold_var() && (Night((long) (Now())) == false);
});

h1156521327.port(get_luminance_port);
h1156521327.action((Event e)->{
final LuminanceMessageType.LuminanceMessage luminance = (LuminanceMessageType.LuminanceMessage) e;
EnergySaving_current_luminance_var = (double) (luminance.lum);
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var() - getEnergySaving_light_off_temp_fall_var()));
});

Transition h1442087873 = new Transition();
h1442087873.from(state_EnergySaving_EnergySaving_Normal).to(state_EnergySaving_EnergySaving_Night);
h1442087873.event(luminanceType);
h1442087873.guard((Event e)->{
final LuminanceMessageType.LuminanceMessage luminance = (LuminanceMessageType.LuminanceMessage) e;
return luminance.lum < getEnergySaving_light_threshold_var() && (Night((long) (Now())) == true);
});

h1442087873.port(get_luminance_port);
h1442087873.action((Event e)->{
final LuminanceMessageType.LuminanceMessage luminance = (LuminanceMessageType.LuminanceMessage) e;
EnergySaving_current_luminance_var = (double) (luminance.lum);
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var() - getEnergySaving_night_temp_fall_var()));
});

Transition h1215764226 = new Transition();
h1215764226.from(state_EnergySaving_EnergySaving_Normal).to(state_EnergySaving_EnergySaving_LightOff);
h1215764226.event(set_night_startType);
h1215764226.guard((Event e)->{
final Set_night_startMessageType.Set_night_startMessage set_night_start = (Set_night_startMessageType.Set_night_startMessage) e;
return getEnergySaving_current_luminance_var() < getEnergySaving_light_threshold_var() && (UpdateNightStart((long) (Now()), (long) (set_night_start.time)) == false);
});

h1215764226.port(get_day_night_time_port);
h1215764226.action((Event e)->{
final Set_night_startMessageType.Set_night_startMessage set_night_start = (Set_night_startMessageType.Set_night_startMessage) e;
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var() - getEnergySaving_light_off_temp_fall_var()));
});

Transition h1409473729 = new Transition();
h1409473729.from(state_EnergySaving_EnergySaving_Normal).to(state_EnergySaving_EnergySaving_Night);
h1409473729.event(set_night_startType);
h1409473729.guard((Event e)->{
final Set_night_startMessageType.Set_night_startMessage set_night_start = (Set_night_startMessageType.Set_night_startMessage) e;
return getEnergySaving_current_luminance_var() < getEnergySaving_light_threshold_var() && (UpdateNightStart((long) (Now()), (long) (set_night_start.time)) == true);
});

h1409473729.port(get_day_night_time_port);
h1409473729.action((Event e)->{
final Set_night_startMessageType.Set_night_startMessage set_night_start = (Set_night_startMessageType.Set_night_startMessage) e;
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var() - getEnergySaving_night_temp_fall_var()));
});

Transition h530057036 = new Transition();
h530057036.from(state_EnergySaving_EnergySaving_Normal).to(state_EnergySaving_EnergySaving_Normal);
h530057036.event(set_day_startType);
h530057036.guard((Event e)->{
final Set_day_startMessageType.Set_day_startMessage set_day_start = (Set_day_startMessageType.Set_day_startMessage) e;
return getEnergySaving_current_luminance_var() >= getEnergySaving_light_threshold_var();
});

h530057036.port(get_day_night_time_port);
h530057036.action((Event e)->{
final Set_day_startMessageType.Set_day_startMessage set_day_start = (Set_day_startMessageType.Set_day_startMessage) e;
TimeStuff_night_end_var = (long) (set_day_start.time);
});

Transition h1571426710 = new Transition();
h1571426710.from(state_EnergySaving_EnergySaving_Normal).to(state_EnergySaving_EnergySaving_Normal);
h1571426710.event(set_night_startType);
h1571426710.guard((Event e)->{
final Set_night_startMessageType.Set_night_startMessage set_night_start = (Set_night_startMessageType.Set_night_startMessage) e;
return getEnergySaving_current_luminance_var() >= getEnergySaving_light_threshold_var();
});

h1571426710.port(get_day_night_time_port);
h1571426710.action((Event e)->{
final Set_night_startMessageType.Set_night_startMessage set_night_start = (Set_night_startMessageType.Set_night_startMessage) e;
TimeStuff_night_start_var = (long) (set_night_start.time);
});

Transition h1091634544 = new Transition();
h1091634544.from(state_EnergySaving_EnergySaving_LightOff).to(state_EnergySaving_EnergySaving_Night);
h1091634544.event(timer_timeoutType);
h1091634544.port(energy_timer_port);
h1091634544.action((Event e)->{
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var() - getEnergySaving_night_temp_fall_var()));
});

Transition h1608014515 = new Transition();
h1608014515.from(state_EnergySaving_EnergySaving_LightOff).to(state_EnergySaving_EnergySaving_Normal);
h1608014515.event(luminanceType);
h1608014515.guard((Event e)->{
final LuminanceMessageType.LuminanceMessage luminance = (LuminanceMessageType.LuminanceMessage) e;
return luminance.lum >= getEnergySaving_light_threshold_var();
});

h1608014515.port(get_luminance_port);
h1608014515.action((Event e)->{
final LuminanceMessageType.LuminanceMessage luminance = (LuminanceMessageType.LuminanceMessage) e;
EnergySaving_current_luminance_var = (double) (luminance.lum);
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var()));
});

Transition h923941110 = new Transition();
h923941110.from(state_EnergySaving_EnergySaving_LightOff).to(state_EnergySaving_EnergySaving_LightOff);
h923941110.event(set_temperatureType);
h923941110.port(human_input_temp_port);
h923941110.action((Event e)->{
final Set_temperatureMessageType.Set_temperatureMessage set_temperature = (Set_temperatureMessageType.Set_temperatureMessage) e;
sendSet_temperature_via_send_comfort_temp((double) (set_temperature.t - getEnergySaving_light_off_temp_fall_var()));
});

Transition h269728575 = new Transition();
h269728575.from(state_EnergySaving_EnergySaving_LightOff).to(state_EnergySaving_EnergySaving_Night);
h269728575.event(set_night_startType);
h269728575.guard((Event e)->{
final Set_night_startMessageType.Set_night_startMessage set_night_start = (Set_night_startMessageType.Set_night_startMessage) e;
return (UpdateNightStart((long) (Now()), (long) (set_night_start.time)) == true) && getEnergySaving_current_luminance_var() < getEnergySaving_light_threshold_var();
});

h269728575.port(get_day_night_time_port);
h269728575.action((Event e)->{
final Set_night_startMessageType.Set_night_startMessage set_night_start = (Set_night_startMessageType.Set_night_startMessage) e;
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var() - getEnergySaving_night_temp_fall_var()));
});

Transition h1081285741 = new Transition();
h1081285741.from(state_EnergySaving_EnergySaving_LightOff).to(state_EnergySaving_EnergySaving_Night);
h1081285741.event(set_day_startType);
h1081285741.guard((Event e)->{
final Set_day_startMessageType.Set_day_startMessage set_day_start = (Set_day_startMessageType.Set_day_startMessage) e;
return getEnergySaving_current_luminance_var() < getEnergySaving_light_threshold_var() && (UpdateNightEnd((long) (Now()), (long) (set_day_start.time)) == true);
});

h1081285741.port(get_day_night_time_port);
h1081285741.action((Event e)->{
final Set_day_startMessageType.Set_day_startMessage set_day_start = (Set_day_startMessageType.Set_day_startMessage) e;
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var() - getEnergySaving_light_off_temp_fall_var()));
});

Transition h1537335211 = new Transition();
h1537335211.from(state_EnergySaving_EnergySaving_LightOff).to(state_EnergySaving_EnergySaving_LightOff);
h1537335211.event(set_night_startType);
h1537335211.guard((Event e)->{
final Set_night_startMessageType.Set_night_startMessage set_night_start = (Set_night_startMessageType.Set_night_startMessage) e;
return getEnergySaving_current_luminance_var() < getEnergySaving_light_threshold_var() && (UpdateNightStart((long) (Now()), (long) (set_night_start.time)) == false);
});

h1537335211.port(get_day_night_time_port);
Transition h1942645705 = new Transition();
h1942645705.from(state_EnergySaving_EnergySaving_LightOff).to(state_EnergySaving_EnergySaving_LightOff);
h1942645705.event(set_day_startType);
h1942645705.guard((Event e)->{
final Set_day_startMessageType.Set_day_startMessage set_day_start = (Set_day_startMessageType.Set_day_startMessage) e;
return getEnergySaving_current_luminance_var() < getEnergySaving_light_threshold_var() && (UpdateNightEnd((long) (Now()), (long) (set_day_start.time)) == false);
});

h1942645705.port(get_day_night_time_port);
Transition h302748048 = new Transition();
h302748048.from(state_EnergySaving_EnergySaving_Night).to(state_EnergySaving_EnergySaving_LightOff);
h302748048.event(timer_timeoutType);
h302748048.port(energy_timer_port);
h302748048.action((Event e)->{
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var() - getEnergySaving_light_off_temp_fall_var()));
});

Transition h1613935496 = new Transition();
h1613935496.from(state_EnergySaving_EnergySaving_Night).to(state_EnergySaving_EnergySaving_Normal);
h1613935496.event(luminanceType);
h1613935496.guard((Event e)->{
final LuminanceMessageType.LuminanceMessage luminance = (LuminanceMessageType.LuminanceMessage) e;
return luminance.lum >= getEnergySaving_light_threshold_var();
});

h1613935496.port(get_luminance_port);
h1613935496.action((Event e)->{
final LuminanceMessageType.LuminanceMessage luminance = (LuminanceMessageType.LuminanceMessage) e;
EnergySaving_current_luminance_var = (double) (luminance.lum);
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var()));
});

Transition h622565484 = new Transition();
h622565484.from(state_EnergySaving_EnergySaving_Night).to(state_EnergySaving_EnergySaving_Night);
h622565484.event(set_temperatureType);
h622565484.port(human_input_temp_port);
h622565484.action((Event e)->{
final Set_temperatureMessageType.Set_temperatureMessage set_temperature = (Set_temperatureMessageType.Set_temperatureMessage) e;
EnergySaving_current_comfort_temp_var = (double) (set_temperature.t - getEnergySaving_night_temp_fall_var());
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var()));
});

Transition h777129869 = new Transition();
h777129869.from(state_EnergySaving_EnergySaving_Night).to(state_EnergySaving_EnergySaving_LightOff);
h777129869.event(set_night_startType);
h777129869.guard((Event e)->{
final Set_night_startMessageType.Set_night_startMessage set_night_start = (Set_night_startMessageType.Set_night_startMessage) e;
return getEnergySaving_current_luminance_var() < getEnergySaving_light_threshold_var() && (UpdateNightStart((long) (Now()), (long) (set_night_start.time)) == false);
});

h777129869.port(get_day_night_time_port);
h777129869.action((Event e)->{
final Set_night_startMessageType.Set_night_startMessage set_night_start = (Set_night_startMessageType.Set_night_startMessage) e;
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var() - getEnergySaving_light_off_temp_fall_var()));
});

Transition h1476539565 = new Transition();
h1476539565.from(state_EnergySaving_EnergySaving_Night).to(state_EnergySaving_EnergySaving_LightOff);
h1476539565.event(set_day_startType);
h1476539565.guard((Event e)->{
final Set_day_startMessageType.Set_day_startMessage set_day_start = (Set_day_startMessageType.Set_day_startMessage) e;
return getEnergySaving_current_luminance_var() < getEnergySaving_light_threshold_var() && (UpdateNightEnd((long) (Now()), (long) (set_day_start.time)) == false);
});

h1476539565.port(get_day_night_time_port);
h1476539565.action((Event e)->{
final Set_day_startMessageType.Set_day_startMessage set_day_start = (Set_day_startMessageType.Set_day_startMessage) e;
sendSet_temperature_via_send_comfort_temp((double) (getEnergySaving_current_comfort_temp_var() - getEnergySaving_light_off_temp_fall_var()));
});

Transition h815630981 = new Transition();
h815630981.from(state_EnergySaving_EnergySaving_Night).to(state_EnergySaving_EnergySaving_Night);
h815630981.event(set_night_startType);
h815630981.guard((Event e)->{
final Set_night_startMessageType.Set_night_startMessage set_night_start = (Set_night_startMessageType.Set_night_startMessage) e;
return getEnergySaving_current_luminance_var() < getEnergySaving_light_threshold_var() && (UpdateNightStart((long) (Now()), (long) (set_night_start.time)) == true);
});

h815630981.port(get_day_night_time_port);
Transition h284591372 = new Transition();
h284591372.from(state_EnergySaving_EnergySaving_Night).to(state_EnergySaving_EnergySaving_Night);
h284591372.event(set_day_startType);
h284591372.guard((Event e)->{
final Set_day_startMessageType.Set_day_startMessage set_day_start = (Set_day_startMessageType.Set_day_startMessage) e;
return getEnergySaving_current_luminance_var() < getEnergySaving_light_threshold_var() && (UpdateNightEnd((long) (Now()), (long) (set_day_start.time)) == true);
});

h284591372.port(get_day_night_time_port);
final CompositeState state_EnergySaving_EnergySaving = new CompositeState("EnergySaving");
state_EnergySaving_EnergySaving.onEntry(()->{
sendAdd_lightsensor_via_request_luminance_sensor((int) (1));
});
state_EnergySaving_EnergySaving.add(state_EnergySaving_EnergySaving_Normal);
state_EnergySaving_EnergySaving.add(state_EnergySaving_EnergySaving_LightOff);
state_EnergySaving_EnergySaving.add(state_EnergySaving_EnergySaving_Night);
state_EnergySaving_EnergySaving.initial(state_EnergySaving_EnergySaving_Normal);
return state_EnergySaving_EnergySaving;
}

public Component buildBehavior(String session, Component root) {
if (root == null) {
//Init ports
get_luminance_port = new Port("get_luminance", this);
human_input_temp_port = new Port("human_input_temp", this);
get_day_night_time_port = new Port("get_day_night_time", this);
send_comfort_temp_port = new Port("send_comfort_temp", this);
energy_timer_port = new Port("energy_timer", this);
request_luminance_sensor_port = new Port("request_luminance_sensor", this);
} else {
get_luminance_port = ((EnergySaving)root).get_luminance_port;
human_input_temp_port = ((EnergySaving)root).human_input_temp_port;
get_day_night_time_port = ((EnergySaving)root).get_day_night_time_port;
send_comfort_temp_port = ((EnergySaving)root).send_comfort_temp_port;
energy_timer_port = ((EnergySaving)root).energy_timer_port;
request_luminance_sensor_port = ((EnergySaving)root).request_luminance_sensor_port;
}
if (session == null){
//Init state machine
behavior = buildEnergySaving_EnergySaving();
}
return this;
}

 long Now() {
long timeval_var = 0;
timeval_var = (long) (LocalTime.now().toNanoOfDay()/1000000);
return (long) (timeval_var);
}
 long Timestamp(final int TimeStuff_Timestamp_h_var, final int TimeStuff_Timestamp_m_var, final int TimeStuff_Timestamp_s_var) {
return (long) ((TimeStuff_Timestamp_s_var + TimeStuff_Timestamp_m_var * 60 + TimeStuff_Timestamp_h_var * 60 * 60) * 1000);
}
 long LeftOfDay() {
long n_var = (long) (Now());

long left_var = (long) (getTimeStuff_night_start_var() - n_var);

if(left_var < 0) {
left_var = (long) (left_var + 24 * 60 * 60 * 1000);

}
if( !(Night((long) (n_var)))) {
return (long) (left_var);

} else {
return (long) (0);

}
}
 long LeftOfNight() {
long n_var = (long) (Now());

long left_var = (long) (getTimeStuff_night_end_var() - n_var);

if(left_var < 0) {
left_var = (long) (left_var + 24 * 60 * 60 * 1000);

}
if(Night((long) (n_var))) {
return (long) (left_var);

} else {
return (long) (0);

}
}
 boolean Night(final long TimeStuff_Night_x_var) {
if(getTimeStuff_night_end_var() < getTimeStuff_night_start_var()) {
if(getTimeStuff_night_start_var() <= TimeStuff_Night_x_var || TimeStuff_Night_x_var < getTimeStuff_night_end_var()) {
return (boolean) (true);

} else {
return (boolean) (false);

}

} else {
if(getTimeStuff_night_start_var() <= TimeStuff_Night_x_var && TimeStuff_Night_x_var < getTimeStuff_night_end_var()) {
return (boolean) (true);

} else {
return (boolean) (false);

}

}
}
 boolean UpdateNightStart(final long TimeStuff_UpdateNightStart_x_var, final long TimeStuff_UpdateNightStart_new_night_start_var) {
System.out.println(""+((" Old night start: ")));
System.out.println(""+((getTimeStuff_night_start_var())));
TimeStuff_night_start_var = (long) (TimeStuff_UpdateNightStart_new_night_start_var);
System.out.println(""+((" New night start: ")));
System.out.println(""+((getTimeStuff_night_start_var())));
boolean isNight_var = (boolean) (Night((long) (TimeStuff_UpdateNightStart_x_var)));

System.out.println(""+((isNight_var)));
return (boolean) (isNight_var);
}
 boolean UpdateNightEnd(final long TimeStuff_UpdateNightEnd_x_var, final long TimeStuff_UpdateNightEnd_new_night_end_var) {
System.out.println(""+((" Old night_end: ")));
System.out.println(""+((getTimeStuff_night_start_var())));
TimeStuff_night_end_var = (long) (TimeStuff_UpdateNightEnd_new_night_end_var);
System.out.println(""+((" New night_end: ")));
System.out.println(""+((getTimeStuff_night_start_var())));
boolean isNight_var = (boolean) (Night((long) (TimeStuff_UpdateNightEnd_x_var)));

System.out.println(""+((isNight_var)));
return (boolean) (isNight_var);
}
}
